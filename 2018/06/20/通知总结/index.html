<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="JoinYon&#39;s Blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="http://yoursite.com">
    <!--SEO-->



<meta name="keywords" content="张俊阳"/>



<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->


<title>通知总结 | JoinYon&#39;s Blog</title>


    <link rel="alternate" href="/atom.xml" title="JoinYon&#39;s Blog" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    



    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?a8c8b303b74043f999d08243b00df898";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>



    
</head>


<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  style="background-image:url(http://onq81n53u.bkt.clouddn.com/neweeess_%E5%89%AF%E6%9C%AC.png)"  >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='JoinYon'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
        	<!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
                 <img src="/img/branding.png" alt="Snippet 博客主题" class="img-responsive center-block">
            
    	</div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>主页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Android"><i class="fa "></i>Android</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/技术"><i class="fa "></i>技术</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/工具"><i class="fa "></i>工具</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/区块链"><i class="fa "></i>区块链</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/资讯"><i class="fa "></i>资讯</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/生活"><i class="fa "></i>生活</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/about"><i class="fa "></i>关于</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="通知总结">
            
	            通知总结
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a href="/categories/Android">
            Android
        </a>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
                
                    <a href="/tags/差缺补漏" title='差缺补漏'>
                        差缺补漏
                    </a>
                
            
        </span>
    </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2018/06/20</span>
        </span>
    
</div>

            
            
    </div>
    
    <div class="post-body post-content">
        <h3 id="通知"><a href="#通知" class="headerlink" title="通知"></a>通知</h3><p><a href="https://blog.csdn.net/yxncl/article/details/72801230" target="_blank" rel="noopener">原文</a></p>
<p>通知系统使得用户得知应用中重要的事情，例如有新信息到来或者日历事件提醒。将通知作为一个新的通道，提醒用户重要的事情或者记录下用户没有注意到的事情。</p>
<h3 id="通知的作用"><a href="#通知的作用" class="headerlink" title="通知的作用"></a>通知的作用</h3><ul>
<li>显示接收到的短消息、即时消息等信息（短信、微信、微博）</li>
<li>显示客户端推送的重要消息（如广告、订阅推荐、新版本发布等）</li>
<li>显示正在进行的程序（如：电影下载进度、音乐播放器、后台运行的程序等）</li>
</ul>
<h3 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h3><ol>
<li>获取NotificationManager 实例管理通知；</li>
<li>实例Notification 对象；</li>
<li>关联事件Intent；</li>
<li>发送通知；</li>
</ol>
<h3 id="通知的分类"><a href="#通知的分类" class="headerlink" title="通知的分类"></a>通知的分类</h3><p>常见的通知有很多，这里以具体实例学习巩固通知的使用过程。</p>
<h4 id="1-普通通知"><a href="#1-普通通知" class="headerlink" title="1. 普通通知"></a>1. 普通通知</h4><ul>
<li><p>获取NotificationManager实例：<br><em>Notification对通知进行管理，调用<a href="">Context</a>的<a href="">getSystemService()</a>方法获取。</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NotificationManager manager=(NotificationManager)getSystemService(Context.NOTIFICATION_SERVICE);</span><br></pre></td></tr></table></figure>
</li>
<li><p>实例Notification对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Notification notification=<span class="keyword">new</span> Notification.Builder(Context).build();</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><em>此时只是创建了一个空的Notification对象，并没有实际的作用，可以在build()方法之前使用连缀任意多的方法设置Notification对象。如下是进行一些基本的设置</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Notification notification=<span class="keyword">new</span> NotificationCompat.Builder(Context)</span><br><span class="line">.setContentText(<span class="string">"通知内容"</span>)</span><br><span class="line">.setContentTitle(<span class="string">"通知标题"</span>)</span><br><span class="line">.setSmallIcon(R.mipmap.ic_luncher)</span><br><span class="line">.setLageIcon(BitmapFactory.decodeResource(getResources(),R.drawable.ic_luncher))</span><br><span class="line">.setWen(System.currentTimeMillis())</span><br><span class="line">.build();</span><br></pre></td></tr></table></figure></p>
<p>以上设置了五个方法：</p>
<p><code>setSmallIcon()</code>用于设置通知的小图标，只能使用纯alpha图层的图片进行设置，小图标会显示在系统状态栏上。（alpha图层的图片可以找UI要）<br><br><code>setLargeIcon()</code>设置通知的大图标，当拉下通知后显示的图标。<br><br><code>setWhen()</code>指定通知被创建的时间，以毫秒为单位。</p>
<ul>
<li>关联事件Intent<blockquote>
<p>如果没有关联Intent也是可以的，只是点击的时候没有任何效果，如果在用户点击到时候会跳转到我们指定的页面，那么需要添加一个Intent，此时会用到 <a href="">PendingIntent</a> ,PendingIntent的获取可以根据需求选择 <code>getActivity()</code>,<code>getBroadcast()</code>,<code>getService()</code>等静态方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Intent intent=<span class="keyword">new</span> Intent(Intent.ACTION_VIEW,Uri.parse(<span class="string">"http://joinyon.top"</span>));</span><br><span class="line">PendingInent pendingIntent=PendingIntent.getActivity(<span class="keyword">this</span>,<span class="number">0</span>,intent,<span class="number">0</span>);</span><br><span class="line">Notification notification=<span class="keyword">new</span> NotificationCompat.Builder(<span class="keyword">this</span>)</span><br><span class="line">.setContentIntent(pendingIntent)</span><br><span class="line">.build();</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<p>调用 <code>setContentIntent()</code>方法，传入PendingIntent实例即可，当点击时会打开浏览器进入我的个人博客主页。我们可以继续完善<strong>Notification</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Notification notification=<span class="keyword">new</span> NotificationCompat.Builder(<span class="keyword">this</span>)</span><br><span class="line">...</span><br><span class="line">.setAutoCancel(<span class="keyword">true</span>);点击通知头自动取消</span><br><span class="line"> .setSound(Uri.parse(<span class="string">"android.resource://"</span> + getPackageName() + <span class="string">"/"</span> + R.raw.iphone_ringtone))<span class="comment">// 声音</span></span><br><span class="line"> <span class="comment">//.setLights()// LED</span></span><br><span class="line"> <span class="comment">//.setVibrate()// 震动</span></span><br><span class="line"> <span class="comment">//.setDefaults(NotificationCompat.DEFAULT_ALL)//设置铃声及震动效果</span></span><br><span class="line"> .build();</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong> 控制手机震动需要加入以下权限<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">user-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.VIBRATE"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="2-悬挂式通知"><a href="#2-悬挂式通知" class="headerlink" title="2. 悬挂式通知"></a>2. 悬挂式通知</h4><p>使用步骤和普通一样，不同的是在调用 <code>.build()</code>之前设置<code>.setFullScreenIntent()</code>方法<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">NotificationCompat.Builder  builder=<span class="keyword">new</span> Notification.Builder(<span class="keyword">this</span>);</span><br><span class="line">Notification notification=builder.setSmallIcon(m.mipmap.ic_launcher_round)</span><br><span class="line">.setPriority(Notification.PRIORITY_DEFAULT)<span class="comment">// 通知的优先级</span></span><br><span class="line">.setCategory(Notification.CATEGORY_MESSAGE)<span class="comment">// 通知的类型</span></span><br><span class="line">.setContentTitle(<span class="string">"悬挂式通知"</span>)</span><br><span class="line">.setAutoCancel(<span class="keyword">true</span>)</span><br><span class="line">...</span><br><span class="line">.build();</span><br></pre></td></tr></table></figure></p>
<p><strong>NOTICE</strong><br><code>setPriority()</code>方法共有5个等级：<br></p>
<ol>
<li>PRIORITY_MIN -最低级别(-2);</li>
<li>PRIORITY_LOW -较低级别(-1);</li>
<li>PRIORITY_DEFAULT -默认级别(0);</li>
<li>PRIORITY_HIGH -较高级别(1);</li>
<li>PRIORITY_MAX -最高级别(2);</li>
</ol>
<p>当发出此类型的通知时，通知会以悬挂的方式显示在屏幕上。</p>
<h4 id="3-折叠式通知"><a href="#3-折叠式通知" class="headerlink" title="3. 折叠式通知"></a>3. 折叠式通知</h4><p>折叠式通知需要借助<strong>RemoteViews</strong>来实现<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一步 获取NotificationManager实例</span></span><br><span class="line">       NotificationManager notificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);</span><br><span class="line"></span><br><span class="line">       Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW, Uri.parse(<span class="string">"http://joinyon.top/"</span>));</span><br><span class="line">       PendingIntent pendingIntent = PendingIntent.getActivity(<span class="keyword">this</span>, <span class="number">0</span>, intent, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//设置未下拉的样式R.layout.collapsed</span></span><br><span class="line">       RemoteViews collapsed = <span class="keyword">new</span> RemoteViews(getPackageName(), R.layout.collapsed);</span><br><span class="line">       collapsed.setTextViewText(R.id.collapsed_text, <span class="string">"关闭状态"</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//设置下拉后的样式TR.layout.show</span></span><br><span class="line">       RemoteViews show = <span class="keyword">new</span> RemoteViews(getPackageName(), R.layout.show);</span><br><span class="line">       <span class="comment">// 第二步 实例Notification对象</span></span><br><span class="line">       NotificationCompat.Builder builder = <span class="keyword">new</span> NotificationCompat.Builder(<span class="keyword">this</span>, <span class="string">"0"</span>);</span><br><span class="line">       Notification notification = builder.setAutoCancel(<span class="keyword">true</span>)</span><br><span class="line">               .setSmallIcon(R.mipmap.ic_launcher_round)</span><br><span class="line">               .setLargeIcon(BitmapFactory.decodeResource(getResources(), R.mipmap.ic_launcher))</span><br><span class="line">               .setContentIntent(pendingIntent)</span><br><span class="line">               .setContentText(<span class="string">"JoinYon's Blog"</span>)</span><br><span class="line">               <span class="comment">//第三步</span></span><br><span class="line">               .setCustomContentView(collapsed)</span><br><span class="line">               .setCustomBigContentView(show)</span><br><span class="line">               .setDefaults(NotificationCompat.DEFAULT_ALL)<span class="comment">//设置铃声及震动效果</span></span><br><span class="line">               .build();</span><br><span class="line">       <span class="comment">//第四步 发送通知</span></span><br><span class="line">       notificationManager.notify(<span class="number">0</span>, notification);</span><br></pre></td></tr></table></figure></p>
<h4 id="4-锁屏通知"><a href="#4-锁屏通知" class="headerlink" title="4. 锁屏通知"></a>4. 锁屏通知</h4><p>Android 5.0(API level21)开始，通知可以显示在锁屏上，通过设置选择是否允许敏感的通知内容显示在安全的锁屏上。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过设置setVisibility()方法设置即可</span></span><br><span class="line">...</span><br><span class="line">.setVisibility(VISIBILITY_PUBLIC)</span><br><span class="line">.build();</span><br></pre></td></tr></table></figure></p>
<p><code>setVisibility()</code>方法共有三个选值：</p>
<ol>
<li>VISIBILITY_PRIVATE:显示基本信息，如通知的图标，但隐藏通知的全部内容</li>
<li>VISIBILITY_PUBLIC:显示通知的全部内容</li>
<li>VISIBILITY_SECRET:不显示任何内容，包括图标。</li>
</ol>
<h2 id="未完待续。。。"><a href="#未完待续。。。" class="headerlink" title="未完待续。。。"></a>未完待续。。。</h2>
    </div>

    <div class="post-footer">
        <div>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/2018/06/21/区块链开源项目介绍/" class="pre-post btn btn-default" title='区块链开源项目介绍'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">区块链开源项目介绍</span>
        </a>
    
    
        <a href="/2018/06/14/Android图片长按保存实践/" class="next-post btn btn-default" title='Android图片长按保存实践'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">Android图片长按保存实践</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
<div id="lv-container" data-id="city" data-uid="MTAyMC8zNzEzNC8xMzY2OA">
  <script type="text/javascript">
     (function(d, s) {
         var j, e = d.getElementsByTagName(s)[0];
         if (typeof LivereTower === 'function') { return; }
         j = d.createElement(s);
         j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
         j.async = true;
         e.parentNode.insertBefore(j, e);
     })(document, 'script');
  </script>
</div>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MVP架构介绍"><span class="toc-text">MVP架构介绍</span></a></li></ol>
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<!--<a id="toc-btn">
    <i class="fa fa-bars"></i>
</a>-->

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12"> 
                <span>Copyright &copy; 2017
                </span> | 
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> | 
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>



	<script src="/js/search.js?rev=@@hash"></script>


<script src="/js/app.js?rev=@@hash"></script>


</body>
</html>